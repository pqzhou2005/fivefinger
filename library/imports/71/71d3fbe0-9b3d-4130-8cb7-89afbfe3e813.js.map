{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Game.js"],"names":["cc","Class","extends","Component","properties","minDistance","maxDistance","stickPrefab","default","type","Prefab","fingerPrefab","playerPrefab","onLoad","manager","director","getCollisionManager","enabled","spawnFinger","v2","currentDistance","random","node","on","isValid","player","spawnPlayer","Node","EventType","TOUCH_START","onTouchStart","getComponent","move","stick","getCurrentLength","console","log","Math","abs","finger","width","destroy","moveAndFail","height","event","stopPropagation","loadScene","start","spawnStick","x","y","rotate","off","postion","instantiate","addChild","setPosition","firstFinger","moveUp","moveDown","min","max","floor"],"mappings":"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","file":"Game.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n        minDistance:10,\r\n\r\n        maxDistance:500,\r\n\r\n        stickPrefab: {\r\n            default: null,\r\n            type: cc.Prefab       \r\n        },\r\n\r\n        fingerPrefab: {\r\n            default: null,\r\n            type: cc.Prefab       \r\n        },\r\n\r\n        playerPrefab: {\r\n            default: null,\r\n            type: cc.Prefab       \r\n        },\r\n        \r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n\r\n        //开启碰撞系统\r\n        var manager = cc.director.getCollisionManager();\r\n        manager.enabled = true;\r\n        \r\n        //生成指头\r\n        this.spawnFinger(cc.v2(0,0)); \r\n        this.currentDistance =  this.random(this.minDistance,this.maxDistance);\r\n        this.spawnFinger(cc.v2(this.currentDistance ,0));\r\n\r\n        //指头准备结束，生成猴子\r\n        this.node.on('fingerReady',function(){            \r\n            if(!cc.isValid(this.player)) {\r\n                this.spawnPlayer(cc.v2(0,0));\r\n            } else {\r\n                \r\n            }\r\n\r\n        },this);\r\n\r\n        //猴子准备结束，绑定触摸事件\r\n        this.node.on('playerReady',function() {            \r\n            this.node.on(cc.Node.EventType.TOUCH_START, this.onTouchStart, this);\r\n        },this);\r\n\r\n        //棍子旋转结束，猴子开始移动\r\n        this.node.on('stickRotateOver',function() {\r\n\r\n            this.player.getComponent('Player').move(cc.v2(this.stick.getComponent(\"Stick\").getCurrentLength(),0));\r\n\r\n        },this);\r\n\r\n        //猴子移动结束\r\n        this.node.on('playerMoveOver',function() {\r\n            \r\n            console.log(this.stick.getComponent(\"Stick\").getCurrentLength());\r\n\r\n            console.log(this.currentDistance);\r\n\r\n            if( Math.abs(this.currentDistance - this.stick.getComponent(\"Stick\").getCurrentLength() ) < this.finger.width/2)  {\r\n                \r\n                console.log(Math.abs(this.currentDistance - this.stick.getComponent(\"Stick\").getCurrentLength() ));\r\n                console.log(this.finger.width/2);\r\n                this.stick.destroy();\r\n\r\n            } else {                \r\n                this.player.getComponent('Player').moveAndFail(cc.v2(0,-this.node.height/2));\r\n            }\r\n        },this);\r\n\r\n        //游戏结束，切换场景\r\n        this.node.on('gameOver', function (event) {\r\n            console.log('gameover.................................');\r\n            event.stopPropagation();\r\n\r\n            cc.director.loadScene('start');\r\n        },this);\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    onTouchStart: function(event) {\r\n\r\n        if(!cc.isValid(this.stick)) {        \r\n\r\n            this.spawnStick(cc.v2(this.player.x+this.player.width/2,this.player.y-this.player.height/2));\r\n        \r\n        } else {\r\n        \r\n            this.stick.getComponent('Stick').rotate();\r\n        \r\n            this.node.off(cc.Node.EventType.TOUCH_START, this.onTouchStart, this);\r\n        }\r\n\r\n        console.log(event);\r\n    },\r\n\r\n    // update (dt) {},\r\n\r\n    spawnStick: function(postion) {\r\n        // 使用给定的模板在场景中生成一个新节点\r\n        this.stick = cc.instantiate(this.stickPrefab);\r\n        // 将新增的节点添加到 Canvas 节点下面\r\n        this.node.addChild(this.stick);     \r\n\r\n        this.stick.setPosition(postion);\r\n    }, \r\n\r\n    spawnFinger: function(postion) {\r\n\r\n        this.finger = cc.instantiate(this.fingerPrefab);\r\n        if(!cc.isValid(this.firstFinger)) this.firstFinger = this.finger;\r\n\r\n        this.node.addChild(this.finger);\r\n\r\n        postion.x -= this.node.width/2-this.finger.width/2;\r\n        postion.y -= this.node.height/2+this.finger.height/2;\r\n\r\n        this.finger.setPosition(postion);\r\n\r\n        this.finger.getComponent(\"Finger\").moveUp();\r\n    },  \r\n    \r\n    spawnPlayer: function(postion) {\r\n\r\n        this.player = cc.instantiate(this.playerPrefab);\r\n        this.node.addChild(this.player);\r\n\r\n        postion.x = this.firstFinger.x;\r\n        postion.y = this.node.height/2;\r\n\r\n        this.player.setPosition(postion);\r\n\r\n        this.player.getComponent(\"Player\").moveDown(cc.v2(postion.x,-this.node.height/2+this.firstFinger.height+this.player.height/2));\r\n    },  \r\n\r\n    random: function(min, max) {\r\n        return Math.floor(Math.random()*(max-min+1)+min);\r\n\r\n    },\r\n});\r\n"]}